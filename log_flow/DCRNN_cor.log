data.shape (8064, 492)
../SZTAXI/SZTAXI-flow.pkl
pred_SZTAXI_DCRNN_2205101038 training started Tue May 10 10:38:03 2022
TRAIN XS.shape YS,shape (6428, 12, 492, 1) (6428, 12, 492, 1)
Model Training Started ... Tue May 10 10:38:04 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
/home/cseadmin/dz/DL-Traff-Graph/workSZTAXI-dz/DCRNN.py:273: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(rowsum, -1).flatten()
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 492, 64]          --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-2              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 492, 64]             147,648
|    |    └─DCGRU_Cell: 3-14             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 492, 64]             (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 492, 1]              --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-26             [-1, 492, 64]             147,648
|    └─Linear: 2-1                       [-1, 492, 1]              65
├─DCGRU_Decoder: 1-3                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 492, 64]             (recursive)
|    └─Linear: 2-2                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 492, 64]             (recursive)
|    └─Linear: 2-3                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-5                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-31             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-32             [-1, 492, 64]             (recursive)
|    └─Linear: 2-4                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-6                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-33             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-34             [-1, 492, 64]             (recursive)
|    └─Linear: 2-5                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-7                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-35             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-36             [-1, 492, 64]             (recursive)
|    └─Linear: 2-6                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-8                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-37             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-38             [-1, 492, 64]             (recursive)
|    └─Linear: 2-7                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-9                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-39             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-40             [-1, 492, 64]             (recursive)
|    └─Linear: 2-8                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-10                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-41             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-42             [-1, 492, 64]             (recursive)
|    └─Linear: 2-9                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-11                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-43             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-44             [-1, 492, 64]             (recursive)
|    └─Linear: 2-10                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-12                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-45             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-46             [-1, 492, 64]             (recursive)
|    └─Linear: 2-11                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-13                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-47             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-48             [-1, 492, 64]             (recursive)
|    └─Linear: 2-12                      [-1, 492, 1]              (recursive)
==========================================================================================
Total params: 445,505
Trainable params: 445,505
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 2.89
Params size (MB): 1.70
Estimated Total Size (MB): 4.61
==========================================================================================
XS_torch.shape:   torch.Size([6428, 12, 492, 1])
YS_torch.shape:   torch.Size([6428, 12, 492, 1])
LOSS is : MSE
epoch 0 time used: 64  seconds  train loss: 1.30401211561553 validation loss: 1.4813944747791954
epoch 1 time used: 66  seconds  train loss: 1.4127588887641982 validation loss: 1.554197685635505
epoch 2 time used: 67  seconds  train loss: 1.412118695368977 validation loss: 1.5321918826791185
epoch 3 time used: 67  seconds  train loss: 1.417077489631783 validation loss: 1.5139496362031395
epoch 4 time used: 67  seconds  train loss: 1.3985154986551103 validation loss: 1.5141117104250401
epoch 5 time used: 67  seconds  train loss: 1.4048929131387138 validation loss: 1.5360820761960536
epoch 6 time used: 67  seconds  train loss: 1.4272118859406386 validation loss: 1.5588160521948515
epoch 7 time used: 67  seconds  train loss: 1.4571889971262362 validation loss: 1.5617111535807746
epoch 8 time used: 66  seconds  train loss: 1.465568425814763 validation loss: 1.592042131803522
epoch 9 time used: 67  seconds  train loss: 1.4673578483112166 validation loss: 1.5849372860211044
Early stopping at epoch: 10
YS.shape, YS_pred.shape, (6428, 12, 492, 1) (6428, 12, 492, 1)
YS.shape, YS_pred.shape, (6428, 12, 492) (6428, 12, 492)
****************************************
DCRNN, train, Torch MSE, 1.4300765954e+00, 1.4300765954
DCRNN, train, MSE, RMSE, MAE, MAPE, 87.9970641239, 9.3806750356, 6.8842644507, 56.5702593676
Model Training Ended ... Tue May 10 10:51:30 2022
pred_SZTAXI_DCRNN_2205101038 testing started Tue May 10 10:51:30 2022
TEST XS.shape, YS.shape (1602, 12, 492, 1) (1602, 12, 492, 1)
Model Testing Started ... Tue May 10 10:51:30 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (1602, 12, 492, 1) (1602, 12, 492, 1)
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
DCRNN, test, Torch MSE, 1.2020592314e+00, 1.2020592314
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.7073793582, 8.1674585618, 6.1160644871, 55.5150245555
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.5391926700, 8.1571559180, 6.0963283318, 55.1082334193
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.8202958553, 8.1743682236, 6.1139639252, 55.3570635686
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 67.1407790860, 8.1939477107, 6.1332306109, 55.6594421418
4 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.9720119443, 8.1836429507, 6.1355558364, 55.6502277433
5 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 67.0467630215, 8.1882087798, 6.1308591301, 55.7518818162
6 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.9198088185, 8.1804528492, 6.1253522928, 55.6435843055
7 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.6350932634, 8.1630321121, 6.1135562827, 55.5042145088
8 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.8739544550, 8.1776496902, 6.1219961540, 55.6217048547
9 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.4475597697, 8.1515372642, 6.1047697793, 55.4714034882
10 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.4105983104, 8.1492698023, 6.1093578429, 55.5245885030
11 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.6097836926, 8.1614817094, 6.1151245947, 55.5607028128
12 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 66.0681964377, 8.1282345216, 6.0925567081, 55.3275203979
Model Testing Ended ... Tue May 10 10:51:48 2022
