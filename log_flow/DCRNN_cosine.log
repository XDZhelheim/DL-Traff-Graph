../SZTAXI/SZTAXI-flow.pkl
../SZTAXI/flow_cosine.npy
data.shape (8064, 492)
pred_SZTAXI_DCRNN_2205302112 training started Mon May 30 21:12:26 2022
TRAIN XS.shape YS,shape (6428, 12, 492, 1) (6428, 12, 492, 1)
Model Training Started ... Mon May 30 21:12:26 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 492, 64]          --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-2              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 492, 64]             147,648
|    |    └─DCGRU_Cell: 3-14             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 492, 64]             (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 492, 1]              --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-26             [-1, 492, 64]             147,648
|    └─Linear: 2-1                       [-1, 492, 1]              65
├─DCGRU_Decoder: 1-3                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 492, 64]             (recursive)
|    └─Linear: 2-2                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 492, 64]             (recursive)
|    └─Linear: 2-3                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-5                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-31             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-32             [-1, 492, 64]             (recursive)
|    └─Linear: 2-4                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-6                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-33             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-34             [-1, 492, 64]             (recursive)
|    └─Linear: 2-5                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-7                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-35             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-36             [-1, 492, 64]             (recursive)
|    └─Linear: 2-6                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-8                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-37             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-38             [-1, 492, 64]             (recursive)
|    └─Linear: 2-7                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-9                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-39             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-40             [-1, 492, 64]             (recursive)
|    └─Linear: 2-8                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-10                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-41             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-42             [-1, 492, 64]             (recursive)
|    └─Linear: 2-9                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-11                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-43             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-44             [-1, 492, 64]             (recursive)
|    └─Linear: 2-10                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-12                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-45             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-46             [-1, 492, 64]             (recursive)
|    └─Linear: 2-11                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-13                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-47             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-48             [-1, 492, 64]             (recursive)
|    └─Linear: 2-12                      [-1, 492, 1]              (recursive)
==========================================================================================
Total params: 445,505
Trainable params: 445,505
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 2.89
Params size (MB): 1.70
Estimated Total Size (MB): 4.61
==========================================================================================
XS_torch.shape:   torch.Size([6428, 12, 492, 1])
YS_torch.shape:   torch.Size([6428, 12, 492, 1])
LOSS is : MSE
epoch 0 time used: 65  seconds  train loss: 0.6691783038345543 validation loss: 0.6766330288417304
epoch 1 time used: 67  seconds  train loss: 0.6328968193334332 validation loss: 0.6509284163588909
epoch 2 time used: 68  seconds  train loss: 0.6171019977729656 validation loss: 0.6443352616248439
epoch 3 time used: 68  seconds  train loss: 0.6073853315872962 validation loss: 0.6404683874614203
epoch 4 time used: 68  seconds  train loss: 0.597549515038432 validation loss: 0.6361115242711347
epoch 5 time used: 68  seconds  train loss: 0.5930175510782266 validation loss: 0.6339507156343602
epoch 6 time used: 68  seconds  train loss: 0.588235994490926 validation loss: 0.6277638667851538
epoch 7 time used: 68  seconds  train loss: 0.5858846015984439 validation loss: 0.6336679729952741
epoch 8 time used: 68  seconds  train loss: 0.5826325324995928 validation loss: 0.6182969820440112
epoch 9 time used: 68  seconds  train loss: 0.579024389746518 validation loss: 0.6200377021855976
epoch 10 time used: 68  seconds  train loss: 0.5730760751204674 validation loss: 0.6151179101929736
epoch 11 time used: 68  seconds  train loss: 0.5731312903028464 validation loss: 0.6173708195710064
epoch 12 time used: 68  seconds  train loss: 0.5713386329190321 validation loss: 0.6174117083573223
epoch 13 time used: 68  seconds  train loss: 0.5713336635619445 validation loss: 0.617379550020493
epoch 14 time used: 68  seconds  train loss: 0.5677714572522583 validation loss: 0.6066766099550238
epoch 15 time used: 68  seconds  train loss: 0.5638856004345977 validation loss: 0.612211378059577
epoch 16 time used: 68  seconds  train loss: 0.5588700803550514 validation loss: 0.6046342262581214
epoch 17 time used: 68  seconds  train loss: 0.5604565404726465 validation loss: 0.6126188490521255
epoch 18 time used: 68  seconds  train loss: 0.5603494942612194 validation loss: 0.6060855780074845
epoch 19 time used: 69  seconds  train loss: 0.5580751358360518 validation loss: 0.6050255605533942
epoch 20 time used: 68  seconds  train loss: 0.5530485984780541 validation loss: 0.6075098226912579
epoch 21 time used: 68  seconds  train loss: 0.5559561396306474 validation loss: 0.6074348255176449
epoch 22 time used: 68  seconds  train loss: 0.5535096781352167 validation loss: 0.599323174846706
epoch 23 time used: 68  seconds  train loss: 0.548334460594237 validation loss: 0.6067736601058523
epoch 24 time used: 68  seconds  train loss: 0.5582631462668287 validation loss: 0.6059910984181646
epoch 25 time used: 68  seconds  train loss: 0.5497442057427777 validation loss: 0.6031672486025302
epoch 26 time used: 68  seconds  train loss: 0.5470266497321692 validation loss: 0.5998629064702276
epoch 27 time used: 67  seconds  train loss: 0.5455794102945504 validation loss: 0.6087262213823215
epoch 28 time used: 67  seconds  train loss: 0.5480081175757336 validation loss: 0.6078922816769994
epoch 29 time used: 66  seconds  train loss: 0.551236936496637 validation loss: 0.5980947966599346
epoch 30 time used: 66  seconds  train loss: 0.5462486952500866 validation loss: 0.5960213808871028
epoch 31 time used: 66  seconds  train loss: 0.540879028450544 validation loss: 0.5956827155986235
epoch 32 time used: 66  seconds  train loss: 0.5417474255622875 validation loss: 0.5974538536807198
epoch 33 time used: 66  seconds  train loss: 0.5442008298966149 validation loss: 0.6027512034373497
epoch 34 time used: 66  seconds  train loss: 0.5448886402809773 validation loss: 0.6084043359875086
epoch 35 time used: 66  seconds  train loss: 0.5451376366920525 validation loss: 0.6026288500769221
epoch 36 time used: 66  seconds  train loss: 0.5402197324025682 validation loss: 0.5974852510945714
epoch 37 time used: 65  seconds  train loss: 0.5369093726318896 validation loss: 0.6003194716735859
epoch 38 time used: 65  seconds  train loss: 0.536357556900293 validation loss: 0.5936640165931549
epoch 39 time used: 65  seconds  train loss: 0.5353954888848458 validation loss: 0.5987225996321114
epoch 40 time used: 65  seconds  train loss: 0.5352302211022818 validation loss: 0.6017086357619632
epoch 41 time used: 65  seconds  train loss: 0.5341945306674855 validation loss: 0.6015332791935745
epoch 42 time used: 65  seconds  train loss: 0.5362858815518755 validation loss: 0.6059704700216132
epoch 43 time used: 65  seconds  train loss: 0.5324083537838368 validation loss: 0.5947381145325467
epoch 44 time used: 65  seconds  train loss: 0.5369683142067867 validation loss: 0.6120051068453053
epoch 45 time used: 65  seconds  train loss: 0.5393230441539081 validation loss: 0.5991107756225624
epoch 46 time used: 65  seconds  train loss: 0.5320129683651931 validation loss: 0.6001823760976839
epoch 47 time used: 65  seconds  train loss: 0.5309133369417313 validation loss: 0.5952771460238974
Early stopping at epoch: 48
YS.shape, YS_pred.shape, (6428, 12, 492, 1) (6428, 12, 492, 1)
YS.shape, YS_pred.shape, (6428, 12, 492) (6428, 12, 492)
****************************************
DCRNN, train, Torch MSE, 5.2927156414e-01, 0.5292715641
DCRNN, train, MSE, RMSE, MAE, MAPE, 21.0171780211, 4.5844495876, 3.4846859907, 31.0664683580
Model Training Ended ... Mon May 30 22:08:37 2022
pred_SZTAXI_DCRNN_2205302112 testing started Mon May 30 22:08:37 2022
TEST XS.shape, YS.shape (1602, 12, 492, 1) (1602, 12, 492, 1)
Model Testing Started ... Mon May 30 22:08:38 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (1602, 12, 492, 1) (1602, 12, 492, 1)
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
DCRNN, test, Torch MSE, 5.1758958278e-01, 0.5175895828
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 21.5800870246, 4.6454372264, 3.5593701559, 33.6962521076
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 18.1863467383, 4.2645453144, 3.3243187615, 31.7975729704
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 19.0206391688, 4.3612657760, 3.3849155370, 32.3628395796
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 19.5457282021, 4.4210551006, 3.4245095502, 32.7126502991
4 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 20.0456025519, 4.4772315723, 3.4586712890, 32.8861653805
5 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 20.5471041565, 4.5328913683, 3.4942920227, 33.2372486591
6 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 21.1647759768, 4.6005190986, 3.5317367743, 33.4645330906
7 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 21.8159771626, 4.6707576647, 3.5770518900, 33.8575720787
8 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 22.4326627748, 4.7363132049, 3.6191838115, 34.2003613710
9 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 23.0415532396, 4.8001617931, 3.6619232642, 34.5587342978
10 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 23.7249707887, 4.8708285526, 3.7055269545, 34.8652809858
11 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 24.3555673073, 4.9351359968, 3.7443446670, 35.0835502148
12 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 25.1275834782, 5.0127421117, 3.7891508917, 35.3528439999
Model Testing Ended ... Mon May 30 22:08:55 2022
