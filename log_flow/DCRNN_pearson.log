../SZTAXI/SZTAXI-flow.pkl
../SZTAXI/flow_pearson.npy
data.shape (8064, 492)
pred_SZTAXI_DCRNN_2205302112 training started Mon May 30 21:12:17 2022
TRAIN XS.shape YS,shape (6428, 12, 492, 1) (6428, 12, 492, 1)
Model Training Started ... Mon May 30 21:12:17 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 492, 64]          --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-2              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 492, 64]             147,648
|    |    └─DCGRU_Cell: 3-14             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 492, 64]             (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 492, 1]              --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 492, 64]             75,072
|    |    └─DCGRU_Cell: 3-26             [-1, 492, 64]             147,648
|    └─Linear: 2-1                       [-1, 492, 1]              65
├─DCGRU_Decoder: 1-3                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 492, 64]             (recursive)
|    └─Linear: 2-2                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 492, 64]             (recursive)
|    └─Linear: 2-3                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-5                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-31             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-32             [-1, 492, 64]             (recursive)
|    └─Linear: 2-4                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-6                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-33             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-34             [-1, 492, 64]             (recursive)
|    └─Linear: 2-5                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-7                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-35             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-36             [-1, 492, 64]             (recursive)
|    └─Linear: 2-6                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-8                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-37             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-38             [-1, 492, 64]             (recursive)
|    └─Linear: 2-7                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-9                     [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-39             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-40             [-1, 492, 64]             (recursive)
|    └─Linear: 2-8                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-10                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-41             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-42             [-1, 492, 64]             (recursive)
|    └─Linear: 2-9                       [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-11                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-43             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-44             [-1, 492, 64]             (recursive)
|    └─Linear: 2-10                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-12                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-45             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-46             [-1, 492, 64]             (recursive)
|    └─Linear: 2-11                      [-1, 492, 1]              (recursive)
├─DCGRU_Decoder: 1-13                    [-1, 492, 1]              (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-47             [-1, 492, 64]             (recursive)
|    |    └─DCGRU_Cell: 3-48             [-1, 492, 64]             (recursive)
|    └─Linear: 2-12                      [-1, 492, 1]              (recursive)
==========================================================================================
Total params: 445,505
Trainable params: 445,505
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 2.89
Params size (MB): 1.70
Estimated Total Size (MB): 4.61
==========================================================================================
XS_torch.shape:   torch.Size([6428, 12, 492, 1])
YS_torch.shape:   torch.Size([6428, 12, 492, 1])
LOSS is : MSE
epoch 0 time used: 62  seconds  train loss: 0.6556033108007179 validation loss: 0.6530024759211943
epoch 1 time used: 62  seconds  train loss: 0.6085595879412308 validation loss: 0.6374664620973578
epoch 2 time used: 61  seconds  train loss: 0.5934187011901888 validation loss: 0.6238466717710542
epoch 3 time used: 62  seconds  train loss: 0.5811896481012043 validation loss: 0.6144379048205134
epoch 4 time used: 63  seconds  train loss: 0.5700738271473142 validation loss: 0.6068554680738876
epoch 5 time used: 62  seconds  train loss: 0.5641970743834549 validation loss: 0.6087566071481847
epoch 6 time used: 61  seconds  train loss: 0.5599428709082379 validation loss: 0.6008701496456393
epoch 7 time used: 62  seconds  train loss: 0.5579182850687128 validation loss: 0.6005850738257318
epoch 8 time used: 62  seconds  train loss: 0.5549538679855477 validation loss: 0.5953254029525453
epoch 9 time used: 62  seconds  train loss: 0.5514231237714016 validation loss: 0.5937536077119818
epoch 10 time used: 62  seconds  train loss: 0.5457702630105432 validation loss: 0.5891014669665057
epoch 11 time used: 62  seconds  train loss: 0.5674633388838083 validation loss: 0.596020499865214
epoch 12 time used: 62  seconds  train loss: 0.5508768099809269 validation loss: 0.5937427389087961
epoch 13 time used: 62  seconds  train loss: 0.5475834751366552 validation loss: 0.5874802906121781
epoch 14 time used: 62  seconds  train loss: 0.5443133441347147 validation loss: 0.5900090167771525
epoch 15 time used: 62  seconds  train loss: 0.5461519466524951 validation loss: 0.584210211957865
epoch 16 time used: 62  seconds  train loss: 0.5409486456582082 validation loss: 0.5825906938581324
epoch 17 time used: 62  seconds  train loss: 0.5388463378630864 validation loss: 0.5849533955849225
epoch 18 time used: 61  seconds  train loss: 0.5367348389978259 validation loss: 0.5871781270895431
epoch 19 time used: 62  seconds  train loss: 0.5382055323968402 validation loss: 0.5822326664011277
epoch 20 time used: 62  seconds  train loss: 0.5411548575500337 validation loss: 0.5866221447489155
epoch 21 time used: 62  seconds  train loss: 0.5366482872881557 validation loss: 0.5821853170347451
epoch 22 time used: 62  seconds  train loss: 0.5359010485293686 validation loss: 0.5862000673564512
epoch 23 time used: 62  seconds  train loss: 0.536592818849626 validation loss: 0.5820925948186894
epoch 24 time used: 61  seconds  train loss: 0.5354341307541045 validation loss: 0.5818964035356816
epoch 25 time used: 62  seconds  train loss: 0.5310057219366939 validation loss: 0.5804751767447932
epoch 26 time used: 61  seconds  train loss: 0.5295372716393614 validation loss: 0.5816993452423248
epoch 27 time used: 61  seconds  train loss: 0.5285384377748156 validation loss: 0.5814499906936095
epoch 28 time used: 61  seconds  train loss: 0.529426801891449 validation loss: 0.5876354613707433
epoch 29 time used: 62  seconds  train loss: 0.5276775431327766 validation loss: 0.589411715073372
epoch 30 time used: 62  seconds  train loss: 0.5275321285721248 validation loss: 0.5826802396062595
epoch 31 time used: 61  seconds  train loss: 0.5280195779854678 validation loss: 0.5845828963749444
epoch 32 time used: 62  seconds  train loss: 0.5298230984641682 validation loss: 0.5856859446758061
epoch 33 time used: 61  seconds  train loss: 0.5302498945979611 validation loss: 0.5854071357950049
epoch 34 time used: 62  seconds  train loss: 0.5245982718840771 validation loss: 0.5836092633987541
Early stopping at epoch: 35
YS.shape, YS_pred.shape, (6428, 12, 492, 1) (6428, 12, 492, 1)
YS.shape, YS_pred.shape, (6428, 12, 492) (6428, 12, 492)
****************************************
DCRNN, train, Torch MSE, 5.2142964530e-01, 0.5214296453
DCRNN, train, MSE, RMSE, MAE, MAPE, 19.9414150878, 4.4655811590, 3.4069612205, 30.4503083229
Model Training Ended ... Mon May 30 21:50:37 2022
pred_SZTAXI_DCRNN_2205302112 testing started Mon May 30 21:50:37 2022
TEST XS.shape, YS.shape (1602, 12, 492, 1) (1602, 12, 492, 1)
Model Testing Started ... Mon May 30 21:50:37 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (1602, 12, 492, 1) (1602, 12, 492, 1)
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
DCRNN, test, Torch MSE, 1.0291235983e+00, 1.0291235983
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 48.5180583259, 6.9654905302, 5.3173001008, 49.1378664970
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 31.6316305033, 5.6242004324, 4.3349628838, 41.1280661821
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 28.7296738582, 5.3600068898, 4.0779612252, 37.9302859306
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 50.8301463321, 7.1295263750, 5.5475546364, 50.6590962410
4 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 57.3297847740, 7.5716434659, 5.9290541562, 56.2196075916
5 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 44.1496807753, 6.6445226146, 5.1407243708, 48.0989873409
6 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 47.0833777901, 6.8617328562, 5.3046221213, 48.8121390343
7 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 47.1548463149, 6.8669386421, 5.2389412335, 47.2786575556
8 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 61.5265218833, 7.8438843619, 6.0628641111, 57.3408901691
9 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 47.0259533017, 6.8575471782, 5.2167538771, 47.8457570076
10 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 51.8785969508, 7.2026798451, 5.5004708235, 49.9773204327
11 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 51.5648840329, 7.1808693090, 5.4107330340, 48.7650096416
12 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 63.4596449600, 7.9661562224, 6.0506515340, 55.6596100330
Model Testing Ended ... Mon May 30 21:50:58 2022
