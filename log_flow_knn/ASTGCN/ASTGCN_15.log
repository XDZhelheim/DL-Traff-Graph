../SZTAXI/SZTAXI-flow.pkl
../SZTAXI/adj_15.npy
data.shape (8064, 492)
pred_SZTAXI_ASTGCN_2206171544 training started Fri Jun 17 15:44:01 2022
TRAIN XS.shape YS,shape (2408, 492, 1, 60) (2408, 492, 12)
Model Training Started ... Fri Jun 17 15:44:01 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─ModuleList: 1                               []                        --
|    └─ASTGCN_block: 2-1                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-1     [-1, 60, 60]              8,185
|    |    └─Spatial_Attention_layer: 3-2      [-1, 492, 492]            484,249
|    |    └─cheb_conv_withSAt: 3-3            [-1, 492, 64, 60]         192
|    |    └─Conv2d: 3-4                       [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-5                       [-1, 64, 492, 30]         128
|    |    └─LayerNorm: 3-6                    [-1, 30, 492, 64]         128
|    └─ASTGCN_block: 2-2                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-7     [-1, 30, 30]              33,844
|    |    └─Spatial_Attention_layer: 3-8      [-1, 492, 492]            486,142
|    |    └─cheb_conv_withSAt: 3-9            [-1, 492, 64, 30]         12,288
|    |    └─Conv2d: 3-10                      [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-11                      [-1, 64, 492, 30]         4,160
|    |    └─LayerNorm: 3-12                   [-1, 30, 492, 64]         128
├─Conv2d: 1-1                                 [-1, 12, 492, 1]          23,052
===============================================================================================
Total params: 1,077,200
Trainable params: 1,077,200
Non-trainable params: 0
Total mult-adds (M): 435.51
===============================================================================================
Input size (MB): 0.11
Forward/backward pass size (MB): 47.02
Params size (MB): 4.11
Estimated Total Size (MB): 51.24
===============================================================================================
LOSS is : MSE
epoch 0 time used: 40  seconds  train loss: 0.8691138635046062 , validation loss: 0.7893425190567575
epoch 1 time used: 40  seconds  train loss: 0.7219267703087113 , validation loss: 0.7886424333946254
epoch 2 time used: 40  seconds  train loss: 0.7192643821154605 , validation loss: 0.7788103830774757
epoch 3 time used: 40  seconds  train loss: 0.7041657021049079 , validation loss: 0.7866123748380084
epoch 4 time used: 40  seconds  train loss: 0.695953100056913 , validation loss: 0.7937566291454227
epoch 5 time used: 40  seconds  train loss: 0.6957492498803829 , validation loss: 0.7759194954289155
epoch 6 time used: 40  seconds  train loss: 0.6798404116567187 , validation loss: 0.780327443070586
epoch 7 time used: 40  seconds  train loss: 0.6750461734127647 , validation loss: 0.7929187403168789
epoch 8 time used: 40  seconds  train loss: 0.6729218956979462 , validation loss: 0.7894356733936804
epoch 9 time used: 40  seconds  train loss: 0.6669687702297089 , validation loss: 0.788427131912637
epoch 10 time used: 40  seconds  train loss: 0.6662318295758088 , validation loss: 0.7936404163259209
epoch 11 time used: 40  seconds  train loss: 0.6580601212929706 , validation loss: 0.7793609810825994
epoch 12 time used: 40  seconds  train loss: 0.656546224730808 , validation loss: 0.7772681231910604
epoch 13 time used: 40  seconds  train loss: 0.6553470713864812 , validation loss: 0.8016906703429365
epoch 14 time used: 40  seconds  train loss: 0.6528142028416171 , validation loss: 0.7731464970547496
epoch 15 time used: 40  seconds  train loss: 0.6452439903194552 , validation loss: 0.7731752688702554
epoch 16 time used: 40  seconds  train loss: 0.6439913735041191 , validation loss: 0.7875586060986567
epoch 17 time used: 40  seconds  train loss: 0.642829121262415 , validation loss: 0.7828272363276181
epoch 18 time used: 40  seconds  train loss: 0.6416164067157026 , validation loss: 0.7756251684851029
epoch 19 time used: 40  seconds  train loss: 0.6370406840500472 , validation loss: 0.772285675289623
epoch 20 time used: 40  seconds  train loss: 0.6366644911591793 , validation loss: 0.777793926654068
epoch 21 time used: 40  seconds  train loss: 0.6330897443997221 , validation loss: 0.7753787686262416
epoch 22 time used: 40  seconds  train loss: 0.6341748047225781 , validation loss: 0.7934421807824575
epoch 23 time used: 40  seconds  train loss: 0.6330476416532157 , validation loss: 0.7970117203817019
epoch 24 time used: 40  seconds  train loss: 0.6335214878859879 , validation loss: 0.7842845669220452
epoch 25 time used: 40  seconds  train loss: 0.6280655287485526 , validation loss: 0.7925810156470517
epoch 26 time used: 40  seconds  train loss: 0.6254826266447627 , validation loss: 0.7952086275994183
epoch 27 time used: 40  seconds  train loss: 0.6238847666008528 , validation loss: 0.785440073060831
epoch 28 time used: 40  seconds  train loss: 0.6238415122145321 , validation loss: 0.7995291912674508
Early stopping at epoch: 29
YS.shape, YS_pred.shape, (2408, 492, 12) (2408, 492, 12)
YS.shape, YS_pred.shape, (2408, 12, 492) (2408, 12, 492)
****************************************
ASTGCN, TRAIN, Torch MSE, 6.1999627140e-01, 0.6199962714

ASTGCN, TRAIN, MSE, RMSE, MAE, MAPE, 24.7304331071, 4.9729702500, 3.7121854130, 32.6172560453

Model Training Ended ... Fri Jun 17 16:05:06 2022
pred_SZTAXI_ASTGCN_2206171544 testing started Fri Jun 17 16:05:06 2022
TEST XS.shape, YS.shape (1602, 492, 1, 60) (1602, 492, 12)
Model Testing Started ... Fri Jun 17 16:05:06 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
LOSS is : MSE
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
ASTGCN, TEST, Torch MSE, 5.4533236112e-01, 0.5453323611

all pred steps, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.0239850298, 4.7983314839, 3.6443099303, 34.2244416475

1 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 19.6653280332, 4.4345606359, 3.4225697092, 32.4898630381
2 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 20.8143873831, 4.5622787489, 3.5059922201, 33.0141335726
3 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.2662667229, 4.6115362649, 3.5432778259, 33.4619790316
4 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.8920892929, 4.6788982991, 3.5865260913, 33.7451905012
5 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.9344631292, 4.6834242952, 3.5751836091, 33.7046265602
6 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 22.6051477227, 4.7544871146, 3.6194872320, 33.9257955551
7 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.1003232236, 4.8062795615, 3.6510100248, 34.2533588409
8 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 24.0688734484, 4.9060038166, 3.7211227018, 34.7348779440
9 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 24.3483801985, 4.9344077860, 3.7305867837, 34.8903864622
10 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 25.0876193661, 5.0087542729, 3.7726022036, 35.3120326996
11 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 25.3914418644, 5.0389921477, 3.7792099869, 35.4578822851
12 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 26.1564084580, 5.1143336280, 3.8267660101, 35.7245475054
Model Testing Ended ... Fri Jun 17 16:05:34 2022
