../SZTAXI/SZTAXI-flow.pkl
../SZTAXI/adj_26.npy
data.shape (8064, 492)
pred_SZTAXI_ASTGCN_2206171916 training started Fri Jun 17 19:16:09 2022
TRAIN XS.shape YS,shape (2408, 492, 1, 60) (2408, 492, 12)
Model Training Started ... Fri Jun 17 19:16:10 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─ModuleList: 1                               []                        --
|    └─ASTGCN_block: 2-1                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-1     [-1, 60, 60]              8,185
|    |    └─Spatial_Attention_layer: 3-2      [-1, 492, 492]            484,249
|    |    └─cheb_conv_withSAt: 3-3            [-1, 492, 64, 60]         192
|    |    └─Conv2d: 3-4                       [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-5                       [-1, 64, 492, 30]         128
|    |    └─LayerNorm: 3-6                    [-1, 30, 492, 64]         128
|    └─ASTGCN_block: 2-2                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-7     [-1, 30, 30]              33,844
|    |    └─Spatial_Attention_layer: 3-8      [-1, 492, 492]            486,142
|    |    └─cheb_conv_withSAt: 3-9            [-1, 492, 64, 30]         12,288
|    |    └─Conv2d: 3-10                      [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-11                      [-1, 64, 492, 30]         4,160
|    |    └─LayerNorm: 3-12                   [-1, 30, 492, 64]         128
├─Conv2d: 1-1                                 [-1, 12, 492, 1]          23,052
===============================================================================================
Total params: 1,077,200
Trainable params: 1,077,200
Non-trainable params: 0
Total mult-adds (M): 435.51
===============================================================================================
Input size (MB): 0.11
Forward/backward pass size (MB): 47.02
Params size (MB): 4.11
Estimated Total Size (MB): 51.24
===============================================================================================
LOSS is : MSE
epoch 0 time used: 40  seconds  train loss: 0.8691995985201314 , validation loss: 0.7894256340704883
epoch 1 time used: 40  seconds  train loss: 0.7221325574806079 , validation loss: 0.7880921015311714
epoch 2 time used: 40  seconds  train loss: 0.7194531776071104 , validation loss: 0.7783563796467955
epoch 3 time used: 40  seconds  train loss: 0.7041731699417143 , validation loss: 0.786384854205819
epoch 4 time used: 40  seconds  train loss: 0.6954417069715293 , validation loss: 0.7942206400177407
epoch 5 time used: 40  seconds  train loss: 0.6949275167960378 , validation loss: 0.7759267640272248
epoch 6 time used: 40  seconds  train loss: 0.6777218169208721 , validation loss: 0.7807863481417051
epoch 7 time used: 40  seconds  train loss: 0.6726954537202919 , validation loss: 0.7926032650114294
epoch 8 time used: 40  seconds  train loss: 0.6697229642295476 , validation loss: 0.7876991138505777
epoch 9 time used: 40  seconds  train loss: 0.6642538052800147 , validation loss: 0.7859303915619454
epoch 10 time used: 40  seconds  train loss: 0.6625328243882044 , validation loss: 0.7884763336656894
epoch 11 time used: 40  seconds  train loss: 0.6557431412806826 , validation loss: 0.7753458098319678
epoch 12 time used: 40  seconds  train loss: 0.6538474552145941 , validation loss: 0.7716159406690503
epoch 13 time used: 40  seconds  train loss: 0.6541034066399862 , validation loss: 0.8017718653346217
epoch 14 time used: 40  seconds  train loss: 0.6516425897852187 , validation loss: 0.7669999355889634
epoch 15 time used: 40  seconds  train loss: 0.6446789888391916 , validation loss: 0.7704848639196732
epoch 16 time used: 40  seconds  train loss: 0.6436453640149791 , validation loss: 0.7762326558563004
epoch 17 time used: 40  seconds  train loss: 0.6426529916021911 , validation loss: 0.7754163296515759
epoch 18 time used: 41  seconds  train loss: 0.6411869343729114 , validation loss: 0.7695974786812285
epoch 19 time used: 41  seconds  train loss: 0.6373073095442505 , validation loss: 0.7640677021191365
epoch 20 time used: 41  seconds  train loss: 0.6376745216813651 , validation loss: 0.7686662955141543
epoch 21 time used: 41  seconds  train loss: 0.6337075079285143 , validation loss: 0.7688098922124337
epoch 22 time used: 42  seconds  train loss: 0.6345023606476424 , validation loss: 0.7786864414563607
epoch 23 time used: 42  seconds  train loss: 0.6329498732039076 , validation loss: 0.7808858498782415
epoch 24 time used: 42  seconds  train loss: 0.6338125846371245 , validation loss: 0.7692153681552292
epoch 25 time used: 42  seconds  train loss: 0.6287669766894097 , validation loss: 0.7817983029292668
epoch 26 time used: 42  seconds  train loss: 0.6260860559495637 , validation loss: 0.7790788479421622
epoch 27 time used: 42  seconds  train loss: 0.6243685781814274 , validation loss: 0.7720472157199517
epoch 28 time used: 42  seconds  train loss: 0.624229141898669 , validation loss: 0.7849997282028198
epoch 29 time used: 42  seconds  train loss: 0.6242781706935826 , validation loss: 0.7634096032757299
epoch 30 time used: 42  seconds  train loss: 0.6211208120929046 , validation loss: 0.7700289561106913
epoch 31 time used: 42  seconds  train loss: 0.6208967056583329 , validation loss: 0.7757903513718285
epoch 32 time used: 42  seconds  train loss: 0.6184312555537611 , validation loss: 0.7697181444231458
epoch 33 time used: 42  seconds  train loss: 0.6174773105694663 , validation loss: 0.7717086001488062
epoch 34 time used: 42  seconds  train loss: 0.6166669200198821 , validation loss: 0.7712935050856632
epoch 35 time used: 42  seconds  train loss: 0.6155386392573469 , validation loss: 0.7724121729796907
epoch 36 time used: 42  seconds  train loss: 0.6144063357612111 , validation loss: 0.7796860056066037
epoch 37 time used: 42  seconds  train loss: 0.6127154886524543 , validation loss: 0.7705894340312363
epoch 38 time used: 42  seconds  train loss: 0.611104794232043 , validation loss: 0.7731665806516856
Early stopping at epoch: 39
YS.shape, YS_pred.shape, (2408, 492, 12) (2408, 492, 12)
YS.shape, YS_pred.shape, (2408, 12, 492) (2408, 12, 492)
****************************************
ASTGCN, TRAIN, Torch MSE, 6.1150892108e-01, 0.6115089211

ASTGCN, TRAIN, MSE, RMSE, MAE, MAPE, 25.2504894836, 5.0249865158, 3.7777838355, 32.8899443150

Model Training Ended ... Fri Jun 17 19:44:40 2022
pred_SZTAXI_ASTGCN_2206171916 testing started Fri Jun 17 19:44:40 2022
TEST XS.shape, YS.shape (1602, 492, 1, 60) (1602, 492, 12)
Model Testing Started ... Fri Jun 17 19:44:40 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
LOSS is : MSE
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
ASTGCN, TEST, Torch MSE, 5.5029810005e-01, 0.5502981000

all pred steps, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.9511659089, 4.8939928391, 3.6973629607, 34.8103195429

1 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 20.3900742212, 4.5155369804, 3.4932083120, 33.0699205399
2 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 20.8733559465, 4.5687367999, 3.4982841754, 33.1672698259
3 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.5383615584, 4.6409440374, 3.5498675901, 33.5413008928
4 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 22.6594501211, 4.7601943365, 3.6244675247, 34.2081844807
5 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.3990425285, 4.8372556815, 3.6758618141, 34.7151279449
6 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 24.0919907099, 4.9083592686, 3.7065278883, 34.9856525660
7 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 24.4431071377, 4.9439970811, 3.7273138088, 35.1349353790
8 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 24.9642367542, 4.9964223955, 3.7666944838, 35.3265076876
9 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 25.3302544953, 5.0329170960, 3.7858440334, 35.4503750801
10 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 26.0138470689, 5.1003771497, 3.8205252289, 35.7792526484
11 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 26.6981302134, 5.1670233417, 3.8588082750, 36.0939472914
12 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 27.0594228513, 5.2018672466, 3.8637249409, 36.2740337849
Model Testing Ended ... Fri Jun 17 19:45:17 2022
