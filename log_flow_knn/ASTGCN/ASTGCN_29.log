../SZTAXI/SZTAXI-flow.pkl
../SZTAXI/adj_29.npy
data.shape (8064, 492)
pred_SZTAXI_ASTGCN_2206172026 training started Fri Jun 17 20:26:35 2022
TRAIN XS.shape YS,shape (2408, 492, 1, 60) (2408, 492, 12)
Model Training Started ... Fri Jun 17 20:26:36 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─ModuleList: 1                               []                        --
|    └─ASTGCN_block: 2-1                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-1     [-1, 60, 60]              8,185
|    |    └─Spatial_Attention_layer: 3-2      [-1, 492, 492]            484,249
|    |    └─cheb_conv_withSAt: 3-3            [-1, 492, 64, 60]         192
|    |    └─Conv2d: 3-4                       [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-5                       [-1, 64, 492, 30]         128
|    |    └─LayerNorm: 3-6                    [-1, 30, 492, 64]         128
|    └─ASTGCN_block: 2-2                      [-1, 492, 64, 30]         --
|    |    └─Temporal_Attention_layer: 3-7     [-1, 30, 30]              33,844
|    |    └─Spatial_Attention_layer: 3-8      [-1, 492, 492]            486,142
|    |    └─cheb_conv_withSAt: 3-9            [-1, 492, 64, 30]         12,288
|    |    └─Conv2d: 3-10                      [-1, 64, 492, 30]         12,352
|    |    └─Conv2d: 3-11                      [-1, 64, 492, 30]         4,160
|    |    └─LayerNorm: 3-12                   [-1, 30, 492, 64]         128
├─Conv2d: 1-1                                 [-1, 12, 492, 1]          23,052
===============================================================================================
Total params: 1,077,200
Trainable params: 1,077,200
Non-trainable params: 0
Total mult-adds (M): 435.51
===============================================================================================
Input size (MB): 0.11
Forward/backward pass size (MB): 47.02
Params size (MB): 4.11
Estimated Total Size (MB): 51.24
===============================================================================================
LOSS is : MSE
epoch 0 time used: 41  seconds  train loss: 0.8691901618346932 , validation loss: 0.7894128432305548
epoch 1 time used: 42  seconds  train loss: 0.7220287022004492 , validation loss: 0.788345173347828
epoch 2 time used: 42  seconds  train loss: 0.719248729771667 , validation loss: 0.7789785489687492
epoch 3 time used: 42  seconds  train loss: 0.7037760757358933 , validation loss: 0.7878224917028434
epoch 4 time used: 42  seconds  train loss: 0.6948953512781991 , validation loss: 0.7927491858948109
epoch 5 time used: 42  seconds  train loss: 0.6940242748267287 , validation loss: 0.7748634359765291
epoch 6 time used: 42  seconds  train loss: 0.6765433518197449 , validation loss: 0.7813544918928431
epoch 7 time used: 42  seconds  train loss: 0.6705613084239986 , validation loss: 0.7947115668426716
epoch 8 time used: 42  seconds  train loss: 0.6686870123913461 , validation loss: 0.785714660570075
epoch 9 time used: 41  seconds  train loss: 0.6626059854828356 , validation loss: 0.7854193864866744
epoch 10 time used: 42  seconds  train loss: 0.660988647365208 , validation loss: 0.7906224206832556
epoch 11 time used: 42  seconds  train loss: 0.6543999640195926 , validation loss: 0.7747131156366925
epoch 12 time used: 42  seconds  train loss: 0.6516528427742305 , validation loss: 0.7717497289378777
epoch 13 time used: 42  seconds  train loss: 0.6521441433516848 , validation loss: 0.8004207092266146
epoch 14 time used: 42  seconds  train loss: 0.6504855158490822 , validation loss: 0.7653239347609967
epoch 15 time used: 42  seconds  train loss: 0.6429019232864452 , validation loss: 0.7714283460398449
epoch 16 time used: 42  seconds  train loss: 0.6418038483021323 , validation loss: 0.7746290499189763
epoch 17 time used: 42  seconds  train loss: 0.641223935335238 , validation loss: 0.7721619467402614
epoch 18 time used: 42  seconds  train loss: 0.638796858443544 , validation loss: 0.7670258546984473
epoch 19 time used: 42  seconds  train loss: 0.6353835145839878 , validation loss: 0.7647961316710691
epoch 20 time used: 42  seconds  train loss: 0.6359494779140507 , validation loss: 0.7682512293622343
epoch 21 time used: 42  seconds  train loss: 0.6317858432897415 , validation loss: 0.7686505525611168
epoch 22 time used: 42  seconds  train loss: 0.6328370491361867 , validation loss: 0.7765295339185138
epoch 23 time used: 42  seconds  train loss: 0.6312869740256666 , validation loss: 0.7823288915957327
epoch 24 time used: 42  seconds  train loss: 0.6320804301233839 , validation loss: 0.7718916297751012
epoch 25 time used: 42  seconds  train loss: 0.6275700109232417 , validation loss: 0.783745621327942
epoch 26 time used: 41  seconds  train loss: 0.6250420222929659 , validation loss: 0.7824516027076696
epoch 27 time used: 42  seconds  train loss: 0.6233254201218705 , validation loss: 0.7682524464059114
epoch 28 time used: 42  seconds  train loss: 0.6230528151530703 , validation loss: 0.7858109777155905
Early stopping at epoch: 29
YS.shape, YS_pred.shape, (2408, 492, 12) (2408, 492, 12)
YS.shape, YS_pred.shape, (2408, 12, 492) (2408, 12, 492)
****************************************
ASTGCN, TRAIN, Torch MSE, 6.1966638464e-01, 0.6196663846

ASTGCN, TRAIN, MSE, RMSE, MAE, MAPE, 24.4927783247, 4.9490179152, 3.7018864104, 32.4788451195

Model Training Ended ... Fri Jun 17 20:48:18 2022
pred_SZTAXI_ASTGCN_2206172026 testing started Fri Jun 17 20:48:18 2022
TEST XS.shape, YS.shape (1602, 492, 1, 60) (1602, 492, 12)
Model Testing Started ... Fri Jun 17 20:48:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
LOSS is : MSE
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
ASTGCN, TEST, Torch MSE, 5.4943081485e-01, 0.5494308148

all pred steps, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.8183797540, 4.8804077446, 3.6872871646, 34.5495134592

1 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 20.1069099705, 4.4840729221, 3.4588736557, 32.7568769455
2 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.1894149148, 4.6031961630, 3.5328728860, 33.2502633333
3 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 21.8684623521, 4.6763727773, 3.5848604922, 33.7831258774
4 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 22.5463984993, 4.7483048027, 3.6279599035, 34.1060310602
5 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 22.7131315021, 4.7658295712, 3.6203273316, 34.0329825878
6 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.3022615985, 4.8272416139, 3.6564934683, 34.1752767563
7 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 23.9715943608, 4.8960794888, 3.6960088618, 34.6077471972
8 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 25.0220414621, 5.0022036606, 3.7700273156, 35.1240903139
9 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 25.3665891984, 5.0365255086, 3.7804166558, 35.2775573730
10 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 26.2101345048, 5.1195834308, 3.8255458025, 35.7175946236
11 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 26.3974502711, 5.1378449053, 3.8210930619, 35.7462048531
12 step, ASTGCN, TEST, MSE, RMSE, MAE, MAPE, 27.1739383569, 5.2128627794, 3.8756914790, 36.0386610031
Model Testing Ended ... Fri Jun 17 20:48:45 2022
