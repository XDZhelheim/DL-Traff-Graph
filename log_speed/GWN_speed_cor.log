../SZTAXI/SZTAXI-speed.pkl
../SZTAXI/cor_matrix.npy
data.shape (8064, 492)
pred_SZTAXI_GraphWaveNet_2205302234 training started Mon May 30 22:34:12 2022
TRAIN XS.shape YS,shape (6428, 1, 492, 12) (6428, 12, 492, 1)
Model Training Started ... Mon May 30 22:34:13 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 492, 13]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 492, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 492, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 492, 12]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 492, 12]         --
|    |    └─nconv: 3-1                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-2                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-3                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-4                   [-1, 32, 492, 12]         --
|    |    └─linear: 3-5                  [-1, 32, 492, 12]         5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 492, 12]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 492, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 492, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 492, 10]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 492, 10]         --
|    |    └─nconv: 3-6                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-7                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-8                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-9                   [-1, 32, 492, 10]         --
|    |    └─linear: 3-10                 [-1, 32, 492, 10]         5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 492, 10]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 492, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 492, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 492, 9]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 492, 9]          --
|    |    └─nconv: 3-11                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-12                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-13                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-14                  [-1, 32, 492, 9]          --
|    |    └─linear: 3-15                 [-1, 32, 492, 9]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 492, 9]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 492, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 492, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 492, 7]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 492, 7]          --
|    |    └─nconv: 3-16                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-17                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-18                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-19                  [-1, 32, 492, 7]          --
|    |    └─linear: 3-20                 [-1, 32, 492, 7]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 492, 7]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 492, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 492, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 492, 6]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 492, 6]          --
|    |    └─nconv: 3-21                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-22                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-23                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-24                  [-1, 32, 492, 6]          --
|    |    └─linear: 3-25                 [-1, 32, 492, 6]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 492, 6]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 492, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 492, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 492, 4]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 492, 4]          --
|    |    └─nconv: 3-26                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-27                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-28                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-29                  [-1, 32, 492, 4]          --
|    |    └─linear: 3-30                 [-1, 32, 492, 4]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 492, 4]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 492, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 492, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 492, 3]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 492, 3]          --
|    |    └─nconv: 3-31                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-32                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-33                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-34                  [-1, 32, 492, 3]          --
|    |    └─linear: 3-35                 [-1, 32, 492, 3]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 492, 3]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 492, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 492, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 492, 1]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 492, 1]          --
|    |    └─nconv: 3-36                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-37                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-38                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-39                  [-1, 32, 492, 1]          --
|    |    └─linear: 3-40                 [-1, 32, 492, 1]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 492, 1]          64
├─Conv2d: 1-2                            [-1, 512, 492, 1]         131,584
├─Conv2d: 1-3                            [-1, 12, 492, 1]          6,156
==========================================================================================
Total params: 280,396
Trainable params: 280,396
Non-trainable params: 0
Total mult-adds (M): 513.16
==========================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 78.48
Params size (MB): 1.07
Estimated Total Size (MB): 79.57
==========================================================================================
XS_torch.shape:   torch.Size([6428, 1, 492, 12])
YS_torch.shape:   torch.Size([6428, 12, 492, 1])
LOSS is : MSE
epoch 0 time used: 19  seconds  train loss: 0.8719408307780921 validation loss: 0.9634671086695656
epoch 1 time used: 19  seconds  train loss: 0.85112018775126 validation loss: 0.9668974467177889
epoch 2 time used: 19  seconds  train loss: 0.8469626956949193 validation loss: 0.9483820698154506
epoch 3 time used: 19  seconds  train loss: 0.8414062080986978 validation loss: 0.9595641051951925
epoch 4 time used: 19  seconds  train loss: 0.8370975430625601 validation loss: 0.9394980692744848
epoch 5 time used: 19  seconds  train loss: 0.8329773342626363 validation loss: 0.944871959698141
epoch 6 time used: 19  seconds  train loss: 0.8296559854048923 validation loss: 0.9290263216886947
epoch 7 time used: 19  seconds  train loss: 0.823538775125235 validation loss: 0.9389007654949207
epoch 8 time used: 19  seconds  train loss: 0.8188748517382365 validation loss: 0.9340776789247693
epoch 9 time used: 19  seconds  train loss: 0.8156590160740219 validation loss: 0.9229840829004696
epoch 10 time used: 19  seconds  train loss: 0.811587104078377 validation loss: 0.9174663291048648
epoch 11 time used: 19  seconds  train loss: 0.8079385097810249 validation loss: 0.9323560017258373
epoch 12 time used: 19  seconds  train loss: 0.804005472029256 validation loss: 0.9333583460518377
epoch 13 time used: 19  seconds  train loss: 0.7999481709719043 validation loss: 0.9120630316473358
epoch 14 time used: 19  seconds  train loss: 0.7965153426906971 validation loss: 0.9197284751270541
epoch 15 time used: 19  seconds  train loss: 0.7943776125249957 validation loss: 0.9337017826773041
epoch 16 time used: 19  seconds  train loss: 0.7907497960846251 validation loss: 0.9144902009869096
epoch 17 time used: 19  seconds  train loss: 0.7922277236052632 validation loss: 0.9470265931751004
epoch 18 time used: 19  seconds  train loss: 0.786341275039472 validation loss: 0.9282508883903275
epoch 19 time used: 19  seconds  train loss: 0.7840906442653065 validation loss: 0.9144506223166167
epoch 20 time used: 19  seconds  train loss: 0.7823750621733252 validation loss: 0.9256437150993158
epoch 21 time used: 19  seconds  train loss: 0.7805283956473447 validation loss: 0.9123693206417027
epoch 22 time used: 19  seconds  train loss: 0.7796504948590253 validation loss: 0.933072901483792
epoch 23 time used: 19  seconds  train loss: 0.7772448382540413 validation loss: 0.9101143921192606
epoch 24 time used: 19  seconds  train loss: 0.7757290756041091 validation loss: 0.9233299505651293
epoch 25 time used: 19  seconds  train loss: 0.7751301882277173 validation loss: 0.9248874931786191
epoch 26 time used: 19  seconds  train loss: 0.7750722824424972 validation loss: 0.917309228460587
epoch 27 time used: 19  seconds  train loss: 0.7717827525450868 validation loss: 0.9174277604515872
epoch 28 time used: 19  seconds  train loss: 0.7697490899695102 validation loss: 0.9223712567073196
epoch 29 time used: 19  seconds  train loss: 0.7693952932466315 validation loss: 0.9076121535467271
epoch 30 time used: 19  seconds  train loss: 0.7677507574324248 validation loss: 0.9184310371009865
epoch 31 time used: 19  seconds  train loss: 0.7681263184140451 validation loss: 0.9109111914587258
epoch 32 time used: 19  seconds  train loss: 0.7658807339403741 validation loss: 0.9228919394573762
epoch 33 time used: 19  seconds  train loss: 0.7654422369824025 validation loss: 0.9192129177833671
epoch 34 time used: 19  seconds  train loss: 0.7671055448682684 validation loss: 0.9255984303963125
epoch 35 time used: 19  seconds  train loss: 0.7639164052172371 validation loss: 0.9311527375558123
epoch 36 time used: 19  seconds  train loss: 0.7646625387889053 validation loss: 0.9384790261586508
epoch 37 time used: 19  seconds  train loss: 0.7636638452453939 validation loss: 0.932284282214606
epoch 38 time used: 19  seconds  train loss: 0.7612025247698657 validation loss: 0.9175380231136113
Early stopping at epoch: 39
YS.shape, YS_pred.shape, (6428, 12, 492, 1) (6428, 12, 492, 1)
YS.shape, YS_pred.shape, (6428, 12, 492) (6428, 12, 492)
****************************************
GraphWaveNet, train, Torch MSE, 7.6089161821e-01, 0.7608916182
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 41.9932109497, 6.4802168906, 4.5424984234, 24.1763830185
Model Training Ended ... Mon May 30 22:47:42 2022
pred_SZTAXI_GraphWaveNet_2205302234 testing started Mon May 30 22:47:42 2022
TEST XS.shape, YS.shape (1602, 1, 492, 12) (1602, 12, 492, 1)
Model Testing Started ... Mon May 30 22:47:42 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (1602, 12, 492, 1) (1602, 12, 492, 1)
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
GraphWaveNet, test, Torch MSE, 8.2158108314e-01, 0.8215810831
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.2798476521, 6.6543104565, 4.7128675681, 23.7735837698
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.3883706502, 6.5869849438, 4.6422125641, 23.5213875771
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.5964210342, 6.6027585928, 4.6597858577, 23.6071735620
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.7589647491, 6.6150559143, 4.6715185069, 23.6506357789
4 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.9408393060, 6.6287886756, 4.6874299131, 23.6794963479
5 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.1120849514, 6.6416929281, 4.6999222947, 23.6958310008
6 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.1990175535, 6.6482341681, 4.7049633291, 23.7736538053
7 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.3613900326, 6.6604346729, 4.7185846898, 23.7911716104
8 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.5221997464, 6.6724957659, 4.7307186765, 23.8217502832
9 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.6681744323, 6.6834253517, 4.7437484578, 23.8785892725
10 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.7929454286, 6.6927532024, 4.7522877412, 23.9299297333
11 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.9446039000, 6.7040736795, 4.7666008919, 23.9339455962
12 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 45.0731600417, 6.7136547455, 4.7766378946, 23.9994630218
Model Testing Ended ... Mon May 30 22:47:47 2022
