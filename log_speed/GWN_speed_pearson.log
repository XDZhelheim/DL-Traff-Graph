../SZTAXI/SZTAXI-speed.pkl
../SZTAXI/speed_pearson.npy
data.shape (8064, 492)
pred_SZTAXI_GraphWaveNet_2205312047 training started Tue May 31 20:47:18 2022
TRAIN XS.shape YS,shape (6428, 1, 492, 12) (6428, 12, 492, 1)
Model Training Started ... Tue May 31 20:47:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 492, 13]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 492, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 492, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 492, 12]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 492, 12]         --
|    |    └─nconv: 3-1                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-2                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-3                   [-1, 32, 492, 12]         --
|    |    └─nconv: 3-4                   [-1, 32, 492, 12]         --
|    |    └─linear: 3-5                  [-1, 32, 492, 12]         5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 492, 12]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 492, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 492, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 492, 10]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 492, 10]         --
|    |    └─nconv: 3-6                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-7                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-8                   [-1, 32, 492, 10]         --
|    |    └─nconv: 3-9                   [-1, 32, 492, 10]         --
|    |    └─linear: 3-10                 [-1, 32, 492, 10]         5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 492, 10]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 492, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 492, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 492, 9]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 492, 9]          --
|    |    └─nconv: 3-11                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-12                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-13                  [-1, 32, 492, 9]          --
|    |    └─nconv: 3-14                  [-1, 32, 492, 9]          --
|    |    └─linear: 3-15                 [-1, 32, 492, 9]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 492, 9]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 492, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 492, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 492, 7]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 492, 7]          --
|    |    └─nconv: 3-16                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-17                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-18                  [-1, 32, 492, 7]          --
|    |    └─nconv: 3-19                  [-1, 32, 492, 7]          --
|    |    └─linear: 3-20                 [-1, 32, 492, 7]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 492, 7]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 492, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 492, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 492, 6]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 492, 6]          --
|    |    └─nconv: 3-21                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-22                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-23                  [-1, 32, 492, 6]          --
|    |    └─nconv: 3-24                  [-1, 32, 492, 6]          --
|    |    └─linear: 3-25                 [-1, 32, 492, 6]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 492, 6]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 492, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 492, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 492, 4]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 492, 4]          --
|    |    └─nconv: 3-26                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-27                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-28                  [-1, 32, 492, 4]          --
|    |    └─nconv: 3-29                  [-1, 32, 492, 4]          --
|    |    └─linear: 3-30                 [-1, 32, 492, 4]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 492, 4]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 492, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 492, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 492, 3]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 492, 3]          --
|    |    └─nconv: 3-31                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-32                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-33                  [-1, 32, 492, 3]          --
|    |    └─nconv: 3-34                  [-1, 32, 492, 3]          --
|    |    └─linear: 3-35                 [-1, 32, 492, 3]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 492, 3]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 492, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 492, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 492, 1]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 492, 1]          --
|    |    └─nconv: 3-36                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-37                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-38                  [-1, 32, 492, 1]          --
|    |    └─nconv: 3-39                  [-1, 32, 492, 1]          --
|    |    └─linear: 3-40                 [-1, 32, 492, 1]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 492, 1]          64
├─Conv2d: 1-2                            [-1, 512, 492, 1]         131,584
├─Conv2d: 1-3                            [-1, 12, 492, 1]          6,156
==========================================================================================
Total params: 280,396
Trainable params: 280,396
Non-trainable params: 0
Total mult-adds (M): 513.16
==========================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 78.48
Params size (MB): 1.07
Estimated Total Size (MB): 79.57
==========================================================================================
XS_torch.shape:   torch.Size([6428, 1, 492, 12])
YS_torch.shape:   torch.Size([6428, 12, 492, 1])
LOSS is : MSE
epoch 0 time used: 19  seconds  train loss: 0.8283537506718045 validation loss: 0.9232450765163744
epoch 1 time used: 19  seconds  train loss: 0.8109563271148107 validation loss: 0.9091526934163487
epoch 2 time used: 19  seconds  train loss: 0.801177995642422 validation loss: 0.8857795806666512
epoch 3 time used: 19  seconds  train loss: 0.7947011299187564 validation loss: 0.8927140081699808
epoch 4 time used: 19  seconds  train loss: 0.7897364704910755 validation loss: 0.8751044053936479
epoch 5 time used: 19  seconds  train loss: 0.7847338578270305 validation loss: 0.8782983164289104
epoch 6 time used: 19  seconds  train loss: 0.7826313228050981 validation loss: 0.8844541747178605
epoch 7 time used: 19  seconds  train loss: 0.7807277072205143 validation loss: 0.8722923267540054
epoch 8 time used: 19  seconds  train loss: 0.7781637104103609 validation loss: 0.8794598905601312
epoch 9 time used: 19  seconds  train loss: 0.7773960218321039 validation loss: 0.8733633534232182
epoch 10 time used: 19  seconds  train loss: 0.7760740281168801 validation loss: 0.8708935495632798
epoch 11 time used: 19  seconds  train loss: 0.7740729747930937 validation loss: 0.8721357750062325
epoch 12 time used: 19  seconds  train loss: 0.7729537804977992 validation loss: 0.8697498977480836
epoch 13 time used: 19  seconds  train loss: 0.7721023477327773 validation loss: 0.8646052275130998
epoch 14 time used: 19  seconds  train loss: 0.7709823489867437 validation loss: 0.8642563167496107
epoch 15 time used: 19  seconds  train loss: 0.7700435971128483 validation loss: 0.8850359845517287
epoch 16 time used: 19  seconds  train loss: 0.7692940876121033 validation loss: 0.8640195104613233
epoch 17 time used: 19  seconds  train loss: 0.7682114204505769 validation loss: 0.8639351778955602
epoch 18 time used: 19  seconds  train loss: 0.7672163860217945 validation loss: 0.8679906227695409
epoch 19 time used: 19  seconds  train loss: 0.7656372551558537 validation loss: 0.8571285928659771
epoch 20 time used: 19  seconds  train loss: 0.7659169374455089 validation loss: 0.8598290681838989
epoch 21 time used: 19  seconds  train loss: 0.7647161723709378 validation loss: 0.8624574954236918
epoch 22 time used: 19  seconds  train loss: 0.7640129285380987 validation loss: 0.8573728962917233
epoch 23 time used: 19  seconds  train loss: 0.7630259806706251 validation loss: 0.8615772240790561
epoch 24 time used: 19  seconds  train loss: 0.7621903656895774 validation loss: 0.857921379122568
epoch 25 time used: 19  seconds  train loss: 0.7616253362102156 validation loss: 0.8663649022282652
epoch 26 time used: 19  seconds  train loss: 0.7604411848069594 validation loss: 0.8635763917396317
epoch 27 time used: 19  seconds  train loss: 0.7605118654021837 validation loss: 0.8586136286531515
epoch 28 time used: 19  seconds  train loss: 0.7587029525260328 validation loss: 0.8611048157535383
Early stopping at epoch: 29
YS.shape, YS_pred.shape, (6428, 12, 492, 1) (6428, 12, 492, 1)
YS.shape, YS_pred.shape, (6428, 12, 492) (6428, 12, 492)
****************************************
GraphWaveNet, train, Torch MSE, 7.5604369045e-01, 0.7560436905
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 41.5407196393, 6.4452090454, 4.5122531784, 24.0722805262
Model Training Ended ... Tue May 31 20:57:31 2022
pred_SZTAXI_GraphWaveNet_2205312047 testing started Tue May 31 20:57:31 2022
TEST XS.shape, YS.shape (1602, 1, 492, 12) (1602, 12, 492, 1)
Model Testing Started ... Tue May 31 20:57:31 2022
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (1602, 12, 492, 1) (1602, 12, 492, 1)
YS.shape, YS_pred.shape, (1602, 12, 492) (1602, 12, 492)
****************************************
GraphWaveNet, test, Torch MSE, 8.0577730240e-01, 0.8057773024
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.4201895853, 6.5893997895, 4.6265830932, 23.7511038780
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 42.4517504508, 6.5155007828, 4.5461022044, 23.3502998948
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 42.7366153948, 6.5373247888, 4.5724576090, 23.4618663788
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 42.9168586765, 6.5510959905, 4.5880129749, 23.5127240419
4 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.0587659374, 6.5619178551, 4.6006774744, 23.6162573099
5 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.2292424851, 6.5748948649, 4.6086816646, 23.7120300531
6 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.3985349845, 6.5877564454, 4.6191500034, 23.8063290715
7 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.5380013322, 6.5983332238, 4.6367220696, 23.8005146384
8 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.6824811024, 6.6092723580, 4.6492386133, 23.8663986325
9 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.7918692066, 6.6175425353, 4.6582483725, 23.8665625453
10 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 43.9390423636, 6.6286531334, 4.6682898541, 23.9681348205
11 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.0762283034, 6.6389930188, 4.6806582447, 24.0060523152
12 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 44.2228847862, 6.6500289312, 4.6907580332, 24.0458130836
Model Testing Ended ... Tue May 31 20:57:36 2022
